<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serra da Barriga VR</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
</head>
<body>
    <a-scene>
        <a-assets>
            <video id="video360"
                   src="VSS 2025_09.webm"
                   preload="auto"
                   autoplay
                   muted
                   loop="false"
                   playsinline
                   webkit-playsinline>
            </video>
        </a-assets>

        <a-videosphere src="#video360" rotation="0 -90 0"></a-videosphere>

        <a-camera>
            <a-cursor></a-cursor>
        </a-camera>
    </a-scene>

    <script>
        var video = document.getElementById('video360');
        var hasTransitioned = false;

        setTimeout(function() {
            video.muted = false;
            video.play();
        }, 500);

        video.addEventListener('timeupdate', function() {
            if (!hasTransitioned && video.currentTime >= 15) {
                notifyComplete();
            }
        });

        video.addEventListener('ended', function() {
            notifyComplete();
        });

        function notifyComplete() {
            if (hasTransitioned) return;
            hasTransitioned = true;

            if (window.parent && window.parent !== window) {
                window.parent.postMessage({ type: 'video-complete' }, '*');
            }
        }
    </script>
</body>
</html>
